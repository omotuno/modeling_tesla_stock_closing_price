---
title: "bonus assignment (ASS7)"
author: "Olusegun"
date: "4/3/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Download the closing prices from a stock of interest to you from https://finance.yahoo.com/ and propose anappropriate time series model for the time series. Please submit both the data file (.txt format) and youranswer file.

```{r}
rm(list = ls())
data <-  pdfetch_YAHOO("OC")
share.price <- ts(data[,4])

```


```{r}
library(TSA)
library(tseries)
```


# Load and plot the tesla data
```{r}
rm(list = ls())
tsla <- ts(read.table("~/Documents/BGSU/time_series_analysis /bonus assignment/tsla.txt", sep=""))
plot(tsla,ylab="tsla closing stock price",xlab="Year",type="o")
#boxcox transformation
bx <-BoxCox.ar(tsla, method= "burg")
bx$mle
```

# From the plot we can see a clear trend hence the data is not stationary
# For the Box-Cox transformation, The (lamda) λ value is 0 so we can do a log transformation.

# log transformation and difference process
```{r}
plot(log(tsla),ylab="Percentage granted review (Log scale)",xlab="Year",type="o")
plot(diff(log(tsla)),ylab="Difference of logarithms",xlab="Year",type="o")
```

#The log-transformed series  still displays the linear trend, as expected. However, the variance in the {logYt} process is more constant than in the original series. It looks like the log-transformation has “worked”. We are going  to take a difference of the log transformed series to make it stationary
# The first differences of the log-transformed process  appears to be stationary.

```{r}
# ADF test
adf.test(diff(log(tsla)))
```

# The stationarity of the process  is confirmed by the ADF test. The small p-value here (p = 0.01) indicates marginally strong evidence against the null hypothesis. There is relatively sufficient evidence to conclude that the difference of the log transformed tsla process is stationary.


#  First difference sample ACF/PACF/EACF
```{r}
acf(diff(log(tsla),),main="sample ACF of diff(log(TSLA))")
pacf(diff(log(tsla)),main="sample PACF of diff(log(TSLA))")
eacf(diff(log(tsla)))
```

# From the sample acf, eacf and pacf, we can't see a candidate model hence we take the second difference 


# taking the second difference plot, sample acf, pacf and eacf 
```{r}
plot(diff(diff(log(tsla))),ylab="2nd differences",xlab="Time",type="o")
acf(diff(log(tsla)), main = "Sample ACF : 2ND Differences", diff(2))
pacf(diff(log(tsla)), main = "Sample PACF : 2nd DIfferences", diff(2))
eacf(diff(diff(log(tsla))))
```

# from the second difference of the sample eacf, pacf and acf, we can't see still see a clear standout candidate model this means our data is similar to a white noise process.



